import shutil
from pathlib import Path
from unittest.mock import patch

from ams.config import constants, logger_factory
from ams.config.constants import ensure_dir
from ams.marios_workbench.twitter.import_and_predict import valve
from ams.services import file_services, ticker_service

sample_raw_drop_path = Path(constants.TESTS_RESOURCES, "sample_raw_drop.txt")

logger = logger_factory.create(__name__)

def test_create_test_records():
    create_sample_raw_drop(num_records=10)


def create_sample_raw_drop(num_records: int = 100):
    source_path = Path(constants.TWITTER_OVERFLOW_OUTPUT, "raw_drop", "archive", "multithreaded_drop_2021-02-04_23-58-08-285.9.txt")
    with open(str(source_path), "r") as r:
        with open(str(sample_raw_drop_path), "w") as w:
            for i in range(num_records):
                line = r.readline()
                w.write(line)


def test_old_starts():
    raw_drop_main = Path(constants.TWITTER_OUTPUT_RAW_PATH, "raw_drop", "main", sample_raw_drop_path.name)
    shutil.copy(sample_raw_drop_path, raw_drop_main)

    pipe_fitter.process_old()


def test_process():
    # Arrange
    twitter_root_path = Path(constants.TEMP_PATH, "twitter")
    source_file_test_path = Path(constants.TESTS_RESOURCES, "sample_raw_drop.txt")
    test_source_path = Path(twitter_root_path, "raw_drop", "main")
    end_drop_path = Path(twitter_root_path, "end_drop")

    ensure_dir(test_source_path)
    test_path_new = Path(test_source_path, source_file_test_path.name)
    shutil.copy(source_file_test_path, test_path_new)

    output_dir_path = Path(file_services.create_unique_folder_name(constants.TEMP_PATH, prefix="archive_input"))

    with patch("ams.pipes.pipe_fitter.command_service.get_equity_daily_data", return_value=None) as mock_get_equity, \
        patch("ams.pipes.pipe_fitter.command_service.get_equity_fundamentals_data", return_value=None) as mock_get_eq_funda, \
        patch("ams.pipes.pipe_fitter.equity_performance.start") as mock_eq_perf_start:
        # valve.process(twitter_root_path=twitter_root_path, input_archive_path=output_dir_path)

        mock_get_equity.assert_called_once()
        mock_get_eq_funda.assert_called_once()
        mock_eq_perf_start.assert_called_once()

    # Act

    # Assert

model_1 = {'ANIK', 'VIRT', 'AKAM', 'LINC', 'DGLY', 'AAL', 'COWN', 'HGEN', 'HTGM', 'ADSK', 'AFIN', 'GSMG', 'SUMR', 'EAST', 'EHTH', 'QRVO', 'APPF', 'ALXN', 'NXTD', 'HAFC', 'CG', 'MAR', 'ENG', 'RPD', 'ORRF', 'BRP', 'QCRH', 'PASG', 'AWRE', 'SSSS', 'PCH', 'ISRG', 'BYND', 'RSSS', 'APPS', 'CSCO', 'THBR', 'KE', 'NFLX', 'INTU', 'ACHC', 'NEPT', 'PCB', 'IRTC', 'IIN', 'SPTN', 'ERES', 'CENT', 'MRCC', 'CRWD', 'DIOD', 'QELL', 'NOVN', 'IBTX', 'DVAX', 'AMWD', 'MXIM', 'VRA', 'ALVR', 'SABR', 'NVDA', 'BLMN', 'STLD', 'CSPI', 'CAR', 'PCVX', 'CORT', 'BL', 'NTLA', 'ESSA', 'HA', 'ALAC', 'SUNW', 'CDW', 'PULM', 'PFHD', 'HAIN', 'REGI', 'ZG', 'EGLE', 'XPER', 'CHMG', 'BOKF', 'NWL', 'FMTX', 'PLMR', 'ZS', 'PENN', 'DLTR', 'GDS', 'NKLA', 'AVRO', 'ROKU', 'JD', 'MGNX', 'ERIE', 'FNLC', 'WDC', 'ZIXI', 'RCKY', 'TILE', 'OESX', 'GOGO', 'CENX', 'LYTS', 'TBIO', 'HAYN', 'HSIC', 'RAPT', 'SLM', 'EXC', 'PMD', 'TLRY', 'FFBW', 'CRSR', 'ASTE', 'MOR', 'FAT', 'NODK', 'PAYS', 'WOOF', 'LOOP', 'CDNA', 'ENPH', 'SMMT', 'SPWR', 'FMBI', 'NEOG', 'LKQ', 'TTD', 'GH', 'INFN', 'TTMI', 'FULC', 'JYNT', 'LOGI', 'PHAT', 'UXIN', 'EVFM', 'RDNT', 'PLYA', 'ALOT', 'MIDD', 'NVEC', 'AZN', 'PGC', 'SRNE', 'PRTS', 'SYKE', 'RGNX', 'TTWO', 'LINK', 'AXTI', 'INOV', 'IESC', 'SPRT', 'ICHR', 'CAPA', 'TPCO', 'KRBP', 'LOPE', 'GLG', 'GTIM', 'AGNC', 'TAYD', 'SWAV', 'FTNT', 'ORIC', 'OCGN', 'SIGA', 'FITB', 'LIVN', 'DLTH', 'EOLS', 'STAY', 'KALA', 'USAK', 'NYMT', 'CSTL', 'SDGR', 'MMAC', 'ALT', 'SIRI', 'DLPN', 'TURN', 'WING', 'TSRI', 'ABMD', 'FAST', 'SLGG', 'ORLY', 'USIO', 'ALBO', 'IBEX', 'SENEA', 'VSEC', 'LAMR', 'MPB', 'VIAC', 'HURN', 'COHU', 'NTNX', 'ADBE', 'AMCX', 'POAI', 'CTG', 'MBRX', 'TBLT', 'ITRI', 'SFM', 'KOD', 'CLSK', 'HOL', 'ROCK', 'ICMB', 'MYGN', 'UAL', 'PAAS', 'RAIL', 'ICFI', 'GFED', 'SANM', 'AQB', 'NDSN', 'ARQT', 'DUOT', 'QK', 'DAKT', 'GRTX', 'GIII', 'QUIK', 'USCR', 'CBMB', 'CINF', 'SGLB', 'NVCR', 'SOLY', 'FLIR', 'ACGL', 'HARP', 'SND', 'WISA', 'THFF', 'MARA', 'TA', 'MMSI', 'PYPL', 'WW', 'CNFR', 'ACER', 'ETTX', 'HBAN', 'NTEC', 'EWBC', 'TER', 'TIG', 'OPBK', 'TTEC', 'TNDM', 'VG', 'COHR', 'BLKB', 'CDZI', 'GBCI', 'EXPD', 'PRTA', 'ACOR', 'EGOV', 'TSC', 'NBIX', 'GPRE', 'LMB', 'JCOM', 'TW', 'AGYS', 'DDOG', 'IAC', 'ALNY', 'TREE', 'LTBR', 'ETSY', 'GT', 'SSTI', 'TFFP', 'ANNX', 'INGN', 'EVOL', 'LUNA', 'PCSB', 'CERN', 'AGC', 'CPSS', 'EDUC', 'MELI', 'EBIX', 'LHCG', 'PSMT', 'AMD', 'VISL', 'CROX', 'WTBA', 'EFOI', 'HOOK', 'NUVA', 'FARO', 'ORGS', 'NIU', 'CVV', 'DMTK', 'LQDA', 'ASPS', 'PTON', 'BUSE', 'OSIS', 'FORM', 'TCFC', 'MLHR', 'BFST', 'XLNX', 'SNBR', 'FLEX', 'FSLR', 'INCY', 'RAVN', 'CDLX', 'CSX', 'POOL', 'TROW', 'SAGE', 'PI', 'OKTA', 'GNTX', 'REPL', 'AWH', 'MTCH', 'FUV', 'ADI', 'AVAV', 'NPA', 'TWST', 'GRMN', 'TRIP', 'BKSC', 'AVXL', 'PRDO', 'INTC', 'REGN', 'CCRN', 'GNUS', 'BSGM', 'IIVI', 'ATOS', 'SEDG', 'BCTG', 'AVGO', 'ENSG', 'QCOM', 'ATRI', 'NXPI', 'SBT', 'PLPC', 'THCB', 'JAMF', 'AYRO', 'VIR', 'HBT', 'XBIT', 'GRBK', 'HSII', 'GRWG', 'PETQ', 'BRKR', 'LOVE', 'BEAM', 'LE', 'WEN', 'ANSS', 'CREX', 'WLDN', 'ANDE', 'GBT', 'QTRX', 'GP', 'FUSN', 'XOMA', 'PDFS', 'FSBW', 'MTSI', 'NNDM', 'MICT', 'SIVB', 'CELH', 'ESCA', 'TCRR', 'WLTW', 'BMRN', 'FCAP', 'TECH', 'SHBI', 'APPN', 'ACIW', 'SAII', 'AMRB', 'IDXX', 'MSVB', 'FLL', 'ECOL', 'LAZY', 'ESTA', 'TCF', 'RAND', 'CDAK', 'DOCU', 'NXST', 'RDFN', 'JACK', 'FISV', 'ZNTL', 'FFIC', 'ROST', 'SPOK', 'FLGT', 'CCOI', 'MCHP', 'UTMD', 'MWK', 'WYNN', 'BPFH', 'IEA', 'SP', 'VSTM', 'MSFT', 'RILY', 'TSCO', 'SRAX', 'GLDD', 'FUNC', 'KRNT', 'VSTA', 'NMIH', 'DISH', 'AXDX', 'RIVE', 'GMBL', 'SITM', 'ZI', 'NNOX', 'LYRA', 'EYES', 'NKSH', 'SELF', 'HEES', 'FIVE', 'BOXL', 'AMAT', 'HSDT', 'CTAS', 'CPRT', 'UPLD', 'RIOT', 'SYBX', 'WKHS', 'NSIT', 'DISCA', 'AMNB', 'STX', 'INMD', 'TCX', 'FUTU', 'BECN', 'CALB', 'SCYX', 'MSTR', 'BBBY', 'VERU', 'BCOV', 'VRM', 'COLL', 'SBFG', 'SFNC', 'DZSI', 'RMR', 'RLAY', 'EQIX', 'SHYF', 'SLDB', 'BBQ', 'BCRX', 'ALGS', 'PBPB', 'NVAX', 'HOLX', 'AGBA', 'SCKT', 'AVID', 'QLGN', 'GNSS', 'GLAD', 'KERN', 'ATHA', 'BNTC', 'GOCO', 'MYSZ', 'HOMB', 'NAII', 'LMNR', 'SPWH', 'BKEP', 'AVT', 'YNDX', 'ACHV', 'MIK', 'JAZZ', 'ITAC', 'UROV', 'NEXT', 'CCNC', 'USEG', 'NMRK', 'MRSN', 'MDLZ', 'PLUG', 'HAS', 'MNRO', 'FCEL', 'RBBN', 'CARA', 'RDI', 'YORW', 'OFS', 'AMSWA', 'ZYNE', 'URBN', 'BSET', 'HGSH', 'IEC', 'ECHO', 'KTOS', 'CTRN', 'NTES', 'GO', 'SNPS', 'DCT', 'FONR', 'RBNC', 'BNGO', 'FB', 'MERC', 'FLXN', 'PEP', 'IART', 'CME', 'CURI', 'CRAI', 'ROIC', 'NAKD', 'EBAY', 'HEAR', 'CUTR', 'TGLS', 'LRCX', 'CLIR', 'RNET', 'CRDF', 'STNE', 'FOSL', 'SSP', 'NUZE', 'PACW', 'EXPO', 'COOP', 'SBUX', 'CHUY', 'VOXX', 'EA', 'IRDM', 'AMZN', 'UNTY', 'ALGT', 'CASI', 'RRGB', 'GPRO', 'ECOR', 'TZOO', 'GNPX', 'VCNX', 'AMST', 'ELOX', 'INSG', 'CYBE', 'MORN', 'SCVL', 'TC', 'ENTG', 'XPEL', 'TACT', 'PLAY', 'FARM', 'VRRM', 'OSTK', 'PDD', 'BOWX', 'LI', 'CERE', 'GRNV', 'RUN', 'CREE', 'PTC', 'SCPH', 'NICK', 'GBDC', 'OTLK', 'LITE', 'MAT', 'DOMO', 'BILI', 'SBAC', 'UEPS', 'IDCC', 'CMCSA', 'EML', 'CATB', 'RELL', 'PAE', 'SCSC', 'FEYE', 'CASH', 'TXN', 'MKSI', 'EXPE', 'KHC', 'LOCO', 'BCPC', 'AROW', 'FBRX', 'TH', 'OLLI', 'GRIL', 'CRIS', 'FFIV', 'VIOT', 'IPWR', 'FNWB', 'BIDU', 'MDCA', 'ARDS', 'INPX', 'MDNA', 'VRTX', 'AMRK', 'HOPE', 'KLAC', 'BSVN', 'GOVX', 'SINO', 'ULTA', 'TRMB', 'CEVA', 'TSLA', 'LULU', 'PSAC', 'ATRA', 'HCSG', 'MOMO', 'PLUS', 'CHTR', 'CALM', 'HVBC', 'ALLO', 'WBA', 'POWI', 'CASA', 'GOOGL', 'ISNS', 'FATE', 'CAPR', 'SBCF', 'NEO', 'LMST', 'EQ', 'KOSS', 'PPC', 'IMKTA', 'BIIB', 'NTAP', 'ATVI', 'ZSAN', 'MIST', 'UMBF', 'LAUR', 'SRAC', 'NDAQ', 'CZR', 'BOCH', 'ODP', 'MRCY', 'AMSF', 'EXAS', 'DXCM', 'NNBR', 'MIND', 'TELA', 'PPD', 'ASYS', 'ORPH', 'DORM', 'CRSP', 'AAPL', 'GLBZ', 'OPRA', 'HOFV', 'CDNS', 'DADA', 'MU', 'OMP', 'SONO', 'GEVO', 'ASML', 'PRGS', 'WIRE', 'ON', 'THMO', 'HYMC', 'SONA', 'FULT', 'IRBT', 'FSEA', 'TGTX', 'SYNH', 'SFIX', 'HQI', 'LNDC', 'COUP', 'NEWT', 'GXGX', 'BLUE', 'FFBC', 'BAND', 'VFF', 'XP', 'IRMD', 'ASRT', 'RNST', 'CELC', 'LSCC', 'WMG', 'CRUS', 'AREC', 'PODD', 'GDEN', 'HWKN', 'DKNG', 'APTX', 'EXTR', 'ARYA', 'SGEN', 'QLYS', 'CRTO', 'KRMD', 'KIRK', 'AAON', 'VYNE', 'NFE', 'SECO', 'WWR', 'LCNB', 'AVNW', 'PATK', 'TMDX', 'LMPX', 'MYRG', 'UFPI', 'ABUS', 'SAIA', 'BKNG', 'WSFS', 'XRAY', 'MTSC', 'UNIT', 'LAKE', 'KBNT', 'ALGN', 'VITL', 'LYFT', 'APOG', 'DSKE', 'ADP', 'ATNI', 'SPPI', 'IVA', 'AERI', 'AKRO', 'ZM', 'SWKS', 'INSE', 'RBB', 'JBLU', 'VACQ', 'UBX', 'IBKR', 'GILD', 'LANC', 'AMBA', 'TPIC', 'CWST', 'MACK', 'WSC', 'EDSA', 'HONE', 'SAL', 'EYE', 'ATEX', 'RP', 'INFI', 'FREE', 'LPLA', 'FOXA', 'LGIH', 'CAKE', 'OTTR'}
model_2 = {'TXN', 'HCSG', 'METX', 'ZM', 'CVV', 'AVNW', 'VXRT', 'ITRM', 'AVXL', 'STCN', 'PCSB', 'DUOT', 'SSP', 'BOXL', 'THFF', 'EOLS', 'VIRT', 'PSMT', 'MDNA', 'LI', 'FIVE', 'BNFT', 'AMCX', 'FUTU', 'TRMB', 'ATHA', 'EQ', 'ADSK', 'TPIC', 'TCF', 'XPEL', 'AMSF', 'HSDT', 'FSLR', 'LOOP', 'TNDM', 'FATE', 'CASI', 'SCPH', 'GNSS', 'QELL', 'CDLX', 'ULTA', 'IDRA', 'PLMR', 'OVID', 'TTMI', 'UXIN', 'FISV', 'CLRB', 'AZN', 'INTU', 'ABMD', 'CERE', 'RLAY', 'TYME', 'NEXT', 'PLYA', 'AWH', 'VYNE', 'INSM', 'DMTK', 'KALA', 'MMSI', 'CARV', 'EPZM', 'DSKE', 'ASML', 'HA', 'AREC', 'SIGA', 'ZI', 'VRAY', 'LAKE', 'BCLI', 'KE', 'ALVR', 'PEP', 'GLG', 'ZS', 'TGTX', 'INSG', 'NUVA', 'IIVI', 'OFS', 'DMRC', 'ETSY', 'ABEO', 'EVFM', 'TURN', 'BLNK', 'CRAI', 'CEVA', 'GRBK', 'HOL', 'NEWT', 'SCYX', 'MAR', 'TZOO', 'HOFV', 'MARA', 'RCKY', 'ICFI', 'BKNG', 'CAR', 'LTRPA', 'QTRX', 'SCWX', 'FARM', 'USCR', 'EXC', 'CHTR', 'FLDM', 'ARWR', 'AGEN', 'WISA', 'MGI', 'QRHC', 'RRGB', 'KOSS', 'JAMF', 'BOKF', 'EYE', 'CSX', 'FONR', 'NODK', 'FLGT', 'FRPH', 'INFN', 'FTNT', 'NIU', 'MAT', 'EXPO', 'FBSS', 'CROX', 'AAL', 'NXTD', 'SECO', 'LKQ', 'LPTX', 'DLPN', 'EML', 'ANIX', 'JAGX', 'CZR', 'OSS', 'USIO', 'OCGN', 'NEPT', 'IBKR', 'COWN', 'SIRI', 'WMG', 'DTEA', 'ETTX', 'BRQS', 'CLAR', 'SP', 'ON', 'ENOB', 'ACHV', 'AAON', 'RIOT', 'PFSW', 'WSFS', 'CALM', 'OEG', 'GPRE', 'RIVE', 'INO', 'CAPR', 'OTRK', 'AGNC', 'PHUN', 'DAKT', 'NH', 'MNRO', 'BSVN', 'MYSZ', 'JACK', 'MSTR', 'QCRH', 'GHSI', 'GRWG', 'RMR', 'QRVO', 'HCDI', 'MRNA', 'ROKU', 'FUV', 'ADP', 'RBB', 'BOCH', 'ZYNE', 'FORM', 'ECOR', 'SAGE', 'ALXN', 'LYTS', 'DISH', 'HOPE', 'FUSN', 'FNWB', 'GEVO', 'GOVX', 'IDCC', 'SPLK', 'ARQT', 'PAE', 'MIND', 'ACOR', 'GOOGL', 'LAUR', 'EVOK', 'RELL', 'IRBT', 'INTC', 'SDC', 'HWKN', 'KRBP', 'VRM', 'GLUU', 'IRMD', 'UROV', 'QUMU', 'SANM', 'SWAV', 'ASTE', 'NUZE', 'LNSR', 'PCVX', 'SCVL', 'OPBK', 'RPD', 'WEN', 'NTLA', 'MICT', 'QADB', 'KLAC', 'SNES', 'FEYE', 'XRAY', 'CETX', 'SPOK', 'SSSS', 'RBBN', 'FCEL', 'NAKD', 'TACT', 'LFVN', 'ABUS', 'AQMS', 'GNLN', 'ORGS', 'FLEX', 'SLDB', 'MNPR', 'LPLA', 'NOVN', 'UAL', 'TTOO', 'PGEN', 'ARAV', 'NYMT', 'SBFG', 'SINT', 'REG', 'UNTY', 'EYES', 'CME', 'BRY', 'MERC', 'LIVN', 'STX', 'MNKD', 'HBT', 'TFFP', 'MTCH', 'UNIT', 'JAKK', 'ARDS', 'SLM', 'RUN', 'EBAY', 'MIST', 'SAIA', 'CBAY', 'AGC', 'SPRT', 'NNBR', 'BCTG', 'SPTN', 'CALB', 'YNDX', 'VITL', 'TH', 'KERN', 'STAY', 'CREE', 'TELL', 'SRNE', 'ZG', 'CNDT', 'ANNX', 'XP', 'TELA', 'NDAQ', 'BBQ', 'CBMB', 'MACK', 'SONA', 'CLIR', 'PROG', 'ATHX', 'CDW', 'TA', 'USAK', 'OSIS', 'ASUR', 'BNGO', 'AAPL', 'PS', 'MDB', 'CASA', 'RUBY', 'GNPX', 'OTLK', 'BCRX', 'SBT', 'IDEX', 'MSFT', 'TPCO', 'ATVI', 'BOWX', 'ATNX', 'PPD', 'LMNR', 'APTO', 'DOCU', 'TNXP', 'API', 'TMDX', 'DGLY', 'AKAM', 'VRTX', 'WWR', 'SABR', 'ISNS', 'BLKB', 'TLRY', 'RFIL', 'VERU', 'AWRE', 'ELOX', 'MDCA', 'EXPD', 'MBII', 'AUTL', 'PLAY', 'FULT', 'ATNI', 'TTEC', 'ESSA', 'TW', 'BIMI', 'TCON', 'PTC', 'LLNW', 'NNDM', 'SNPS', 'FREE', 'MXIM', 'ADMA', 'CTAS', 'QK', 'NVAX', 'HGSH', 'SLGG', 'FMTX', 'CLRO', 'FARO', 'LOGI', 'OPTN', 'GRMN', 'BRP', 'CNFR', 'JCOM', 'CTXR', 'NMRK', 'INCY', 'ASRT', 'LINC', 'CENT', 'WBA', 'VOXX', 'MTSC', 'GOGO', 'KTRA', 'GRTX', 'PAYS', 'AVGO', 'CAKE', 'FLIR', 'IEC', 'VKTX', 'DKNG', 'ANIK', 'CG', 'CSCW', 'IBEX', 'TRIP', 'NTAP', 'BYND', 'LE', 'HYMC', 'AGYS', 'EXTR', 'COHR', 'PBPB', 'AMRK', 'QLYS', 'BKSC', 'ODP', 'HWCC', 'HOTH', 'AGBA', 'IPDN', 'GBT', 'NFLX', 'KOD', 'SMMT', 'QCOM', 'HAYN', 'FAT', 'CLXT', 'AMAT', 'MORN', 'SSTI', 'SOLY', 'INZY', 'LYFT', 'BKEP', 'HONE', 'RDI', 'PLUG', 'ROCK', 'PCB', 'UEPS', 'GTIM', 'HLIT', 'VIAC', 'FREQ', 'MRKR', 'PRGS', 'KRMD', 'CLNE', 'CYBE', 'AQB', 'DIOD', 'QTT', 'GNUS', 'NMIH', 'NVCR', 'GPRO', 'TILE', 'TER', 'RSSS', 'FSBW', 'VSTM', 'SAL', 'RAIL', 'SYNL', 'KNDI', 'AMST', 'PACW', 'HAS', 'AESE', 'KIN', 'VISL', 'GDS', 'PETQ', 'OKTA', 'ACNB', 'VBLT', 'LIVX', 'FOXA', 'ZIXI', 'IHRT', 'IPWR', 'ANDE', 'LNDC', 'FAST', 'XPER', 'GP', 'BL', 'RBNC', 'XOMA', 'CMCSA', 'UBX', 'HTBX', 'CRBP', 'AYRO', 'CWST', 'BLCM', 'TIG', 'BGCP', 'LCNB', 'ZEUS', 'ZNTL', 'LMB', 'GILD', 'HARP', 'LUNA', 'GT', 'RDFN', 'MOMO', 'ADI', 'AMBA', 'CINF', 'SBUX', 'XSPA', 'MU', 'ENTG', 'ATOS', 'SEEL', 'IESC', 'GRIL', 'AYTU', 'SGLB'}
model_3 = {'CRBP', 'ORLY', 'NXPI', 'MYSZ', 'CODX', 'SP', 'PASG', 'HA', 'PLAY', 'MERC', 'MICT', 'BKNG', 'QUMU', 'EOLS', 'SGEN', 'WOOF', 'MSFT', 'CRSR', 'XPER', 'MSTR', 'FSBW', 'SUNW', 'CTRN', 'DAIO', 'MSVB', 'PTC', 'HALO', 'TTMI', 'VOXX', 'TCRR', 'PPD', 'MKSI', 'HURN', 'BNTC', 'GNTX', 'BKSC', 'BECN', 'PFHD', 'SBUX', 'FCEL', 'TWST', 'SPPI', 'ODP', 'FUNC', 'STX', 'JAN', 'MRNA', 'ZNGA', 'CHNG', 'MRCY', 'MNPR', 'BIDU', 'NVDA', 'EA', 'AMRB', 'ELSE', 'LAMR', 'ALKS', 'CCNC', 'CSOD', 'CDW', 'GT', 'SBFG', 'CSCW', 'OCGN', 'BRQS', 'HBAN', 'RPD', 'EWBC', 'AVGO', 'NRC', 'WBA', 'NFE', 'ADI', 'DYN', 'TC', 'BSVN', 'CWST', 'CNDT', 'CRUS', 'CEMI', 'POOL', 'SBAC', 'XRAY', 'MYGN', 'BTAI', 'QK', 'MXIM', 'AERI', 'INSE', 'INFN', 'BBBY', 'VSEC', 'XLNX', 'EBAY', 'FLIR', 'CHTR', 'INSM', 'AVID', 'RDFN', 'BIOL', 'CMCSA', 'BMRN', 'DLTR', 'COHR', 'IRDM', 'LMB', 'NWL', 'TCF', 'WW', 'GBDC', 'SWKS', 'HARP', 'ITRI', 'BILI', 'RNET', 'RDUS', 'MWK', 'MRSN', 'FLL', 'FREQ', 'SECO', 'WYNN', 'KYMR', 'MACK', 'IMKTA', 'EML', 'WISA', 'DIOD', 'EXPD', 'SEER', 'TRIP', 'PDD', 'UFPI', 'SGMO', 'GIII', 'OLB', 'JACK', 'PSMT', 'RP', 'ZNTL', 'AMBA', 'QRVO', 'JBLU', 'QLYS', 'ZG', 'GRMN', 'TTEC', 'MOMO', 'DCT', 'LMST', 'ANSS', 'LKQ', 'MOR', 'ASUR', 'GOVX', 'IRBT', 'SPWR', 'IART', 'JAZZ', 'MELI', 'AMST', 'NTEC', 'LOGI', 'COWN', 'WDC', 'SUMR', 'ETSY', 'ALNY', 'RAIL', 'AKAM', 'NIU', 'NEWT', 'CLNE', 'MAR', 'ROKU', 'HAS', 'MRCC', 'LAZY', 'KIRK', 'MDCA', 'ESTA', 'BEAM', 'METX', 'BSET', 'FAST', 'ENTG', 'GLUU', 'DISCA', 'OPRA', 'DLPN', 'RAVN', 'TPIC', 'COLL', 'MORN', 'CERN', 'SDGR', 'BCLI', 'TPTX', 'STNE', 'SYNH', 'PSAC', 'AUTL', 'NUZE', 'ENPH', 'CLRB', 'CWBC', 'ALGT', 'DXCM', 'PEP', 'CEVA', 'STLD', 'NEOG', 'HOMB', 'KRNT', 'AREC', 'NUVA', 'SSP', 'CDNS', 'LYFT', 'LITE', 'EXPE', 'IRTC', 'MTSC', 'XELA', 'PODD', 'ANDE', 'FEYE', 'KHC', 'VRTX', 'IBEX', 'TCON', 'FFBC', 'NDAQ', 'GILD', 'PRDO', 'HSIC', 'MDNA', 'FSLR', 'SSSS', 'FBSS', 'NTNX', 'ADP', 'EXTR', 'MPB', 'LCNB', 'MVIS', 'YNDX', 'AESE', 'AVAV', 'AZRX', 'LAUR', 'HCDI', 'SPOK', 'CENT', 'KTOS', 'TTOO', 'PCVX', 'CRWD', 'CARV', 'FISV', 'IRMD', 'JCOM', 'CATB', 'TSLA', 'ACNB', 'LNSR', 'SAGE', 'FOXA', 'UPLD', 'ASRT', 'STRO', 'EGOV', 'LPLA', 'LPTX', 'LTRPA', 'WLTW', 'NTAP', 'BAND', 'SCYX', 'TMDX', 'TER', 'URBN', 'NTLA', 'AGEN', 'TGTX', 'TCFC', 'CARA', 'VSTA', 'SNPS', 'MARA', 'ECOR', 'SSNT', 'HOL', 'CPRT', 'FRPH', 'TBIO', 'APPS', 'NOVN', 'NDSN', 'TSC', 'FUTU', 'CELH', 'SDC', 'GDEN', 'HCSG', 'QTT', 'PS', 'SEDG', 'GBT', 'APTO', 'XP', 'PATK', 'EYES', 'TURN', 'IMVT', 'CERE', 'LANC', 'NBIX', 'SMMT', 'IHRT', 'TREE', 'QCOM', 'RUBY', 'AMRK', 'EPZM', 'LLNW', 'SND', 'SAL', 'VFF', 'FLEX', 'ADBE', 'AVT', 'POAI', 'TROW', 'INTC', 'TTWO', 'DDOG', 'CZR', 'HSII', 'PAAS', 'SPLK', 'FFIV', 'MCHP', 'DAKT', 'DTEA', 'CENX', 'AZN', 'VG', 'CTAS', 'CROX', 'AGYS', 'TTD', 'AMSF', 'AMD', 'CCXI', 'JAMF', 'KIN', 'COHU', 'FIVE', 'RNST', 'AAON', 'ATRA', 'DADA', 'GPRO', 'BWEN', 'DOMO', 'KOSS', 'LI', 'AMZN', 'IBTX', 'ACIW', 'PTON', 'OLLI', 'MNRO', 'MDLZ', 'ARWR', 'IDCC', 'AGBA', 'SPWH', 'MIK', 'PRGS', 'HAIN', 'SCOR', 'RIVE', 'GO', 'CRAI', 'FARO', 'LRCX', 'EDUC', 'TSCO', 'RGNX', 'VIR', 'NKLA', 'VERU', 'IIVI', 'ISRG', 'QLGN', 'FULT', 'DKNG', 'AGNC', 'KE', 'FMBI', 'GP', 'NMRK', 'SFNC', 'ADPT', 'INPX', 'PYPL', 'ABUS', 'ERIE', 'CLAR', 'CRTO', 'OMP', 'MGI', 'CLGN', 'SANM', 'BOWX', 'OSTK', 'ICPT', 'MTCH', 'CBAT', 'CHCI', 'LE', 'TENB', 'TXN', 'ATEX', 'EQ', 'BYND', 'CALB', 'CSCO', 'BIIB', 'BL', 'UMBF', 'BGCP', 'MIDD', 'FATE', 'UXIN', 'APOG', 'AAL', 'ATVI', 'CELC', 'GXGX', 'TFFP', 'ASPS', 'IAC', 'RILY', 'DZSI', 'PRTS', 'GOCO', 'MTSI', 'TECH', 'SWAV', 'ALOT', 'TILE', 'HTBX', 'KLAC', 'GLYC', 'CHUY', 'BLKB', 'CORT', 'PLYA', 'TPCO', 'NVAX', 'CREE', 'PLUS', 'INOV', 'API', 'NXST', 'DSKE', 'ETTX', 'REGI', 'VYNE', 'PAE', 'TACT', 'ALXN', 'SSTI', 'JD', 'CASH', 'ASTE', 'FFIC', 'STCN', 'BOCH', 'FUV', 'SCSC', 'FB', 'BNGO', 'AAPL', 'KNDI', 'WMG', 'EBIX', 'COUP', 'SRNE', 'ITAC', 'TNXP', 'REGN', 'INTU', 'QRHC', 'CALM', 'ASML', 'RBNC', 'LINK', 'AMAT', 'LULU', 'FREE', 'GH', 'SRAC', 'IEC', 'INGN', 'RCKY', 'PFSW', 'ARCT', 'ZSAN', 'RDNT', 'CTG', 'KRMD', 'SIVB', 'ATRI', 'CRSP', 'BOKF', 'TLRY', 'REPL', 'ON', 'CSPI', 'TZOO', 'WEN', 'PLUG', 'ANIK', 'SYKE', 'GDS', 'ECHO', 'EVBG', 'PROG', 'BRKR', 'FCAP', 'ECOL', 'HYMC', 'ACHC', 'NFLX', 'GRWG', 'TNDM', 'IEA', 'SRPT', 'FARM', 'NCMI', 'WKHS', 'ATHA', 'PENN', 'PACW', 'BLUE', 'GOOGL', 'HOLX', 'LTBR', 'PLMR', 'TA', 'GEVO', 'ANY', 'ZM', 'BRKS', 'FTNT', 'HEAR', 'FMTX', 'MDB', 'SIEB', 'VIAC', 'NTES', 'SPTN', 'NVCR', 'SIRI', 'ALEC', 'DOCU', 'LYTS', 'ATOM', 'STOK', 'EVOL', 'KOD', 'ALGS', 'RBBN', 'WING', 'OSIS', 'HWKN', 'FOSL', 'CRDF', 'MMSI', 'OKTA', 'OTTR', 'ROCK', 'PMD', 'VRRM', 'UAL', 'ULTA', 'ZS', 'FLXN', 'HRMY', 'HBT', 'CYBE', 'SFIX', 'LOVE', 'CURI', 'ADSK', 'PGNY', 'THCB', 'HGEN', 'ZI', 'INCY', 'MU', 'CREX', 'IDXX', 'PETQ', 'INFI', 'EXAS', 'USWS', 'PPC', 'NVEC', 'SONO', 'RUN', 'MLHR', 'VRSN', 'BCRX', 'ALLO', 'PDFS', 'ROST', 'SBBP', 'SABR', 'TRMB', 'LQDA', 'RIOT', 'AKRO', 'GFED', 'AWH', 'LHCG', 'SNBR', 'CME', 'XBIT', 'GPRE', 'IDEX', 'JAKK', 'BKEP', 'ALGN', 'BLMN', 'CINF', 'DISH', 'GOGO', 'ACGL', 'SCWX', 'BNFT', 'VSTM', 'ABMD', 'NPA', 'ANNX', 'CAR', 'FONR', 'SINO', 'SSYS'}

def test_foo():
    # Arrange
    tickers = model_1.intersection(model_2.intersection(model_3))
    # Act
    print(tickers)
    # Assert

