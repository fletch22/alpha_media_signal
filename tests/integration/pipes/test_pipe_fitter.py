import shutil
from pathlib import Path
from unittest.mock import patch

from ams.config import constants, logger_factory
from ams.config.constants import ensure_dir
from ams.marios_workbench.twitter.import_and_predict import valve
from ams.services import file_services, ticker_service

sample_raw_drop_path = Path(constants.TESTS_RESOURCES, "sample_raw_drop.txt")

logger = logger_factory.create(__name__)

def test_create_test_records():
    create_sample_raw_drop(num_records=10)


def create_sample_raw_drop(num_records: int = 100):
    source_path = Path(constants.TWITTER_OVERFLOW_OUTPUT, "raw_drop", "archive", "multithreaded_drop_2021-02-04_23-58-08-285.9.txt")
    with open(str(source_path), "r") as r:
        with open(str(sample_raw_drop_path), "w") as w:
            for i in range(num_records):
                line = r.readline()
                w.write(line)


def test_old_starts():
    raw_drop_main = Path(constants.TWITTER_OUTPUT_RAW_PATH, "raw_drop", "main", sample_raw_drop_path.name)
    shutil.copy(sample_raw_drop_path, raw_drop_main)

    pipe_fitter.process_old()


def test_process():
    # Arrange
    twitter_root_path = Path(constants.TEMP_PATH, "twitter")
    source_file_test_path = Path(constants.TESTS_RESOURCES, "sample_raw_drop.txt")
    test_source_path = Path(twitter_root_path, "raw_drop", "main")
    end_drop_path = Path(twitter_root_path, "end_drop")

    ensure_dir(test_source_path)
    test_path_new = Path(test_source_path, source_file_test_path.name)
    shutil.copy(source_file_test_path, test_path_new)

    output_dir_path = Path(file_services.create_unique_folder_name(constants.TEMP_PATH, prefix="archive_input"))

    with patch("ams.pipes.pipe_fitter.command_service.get_equity_daily_data", return_value=None) as mock_get_equity, \
        patch("ams.pipes.pipe_fitter.command_service.get_equity_fundamentals_data", return_value=None) as mock_get_eq_funda, \
        patch("ams.pipes.pipe_fitter.equity_performance.start") as mock_eq_perf_start:
        # valve.process(twitter_root_path=twitter_root_path, input_archive_path=output_dir_path)

        mock_get_equity.assert_called_once()
        mock_get_eq_funda.assert_called_once()
        mock_eq_perf_start.assert_called_once()

    # Act

    # Assert

model_1 = {'EXPE', 'FNCB', 'SND', 'ADTX', 'HPK', 'PLAB', 'ASTE', 'NVAX', 'SCWX', 'FULT', 'FNLC', 'CONN', 'FRPT', 'ADMA', 'COUP', 'CARA', 'FLUX', 'MLAC', 'CMCSA', 'ZUMZ', 'ZM', 'SAL', 'SYNA', 'AXLA', 'AAME', 'ALEC', 'FIVE', 'RDI', 'EXTR', 'XBIT', 'TELA', 'CDEV', 'MGI', 'MMAC', 'STRA', 'OPRA', 'LASR', 'TER', 'ANAB', 'AKRO', 'BLNK', 'LE', 'DIOD', 'TRCH', 'HSIC', 'NARI', 'RKDA', 'HSTM', 'RADA', 'VISL', 'DENN', 'ADXS', 'RCHG', 'SCHL', 'CACC', 'PENN', 'BKNG', 'ATEX', 'ALGT', 'RIOT', 'EGAN', 'FISI', 'STAA', 'BIOC', 'CRON', 'LOGI', 'STKS', 'ASUR', 'AMPH', 'OSTK', 'SRAX', 'TWIN', 'SVRA', 'TRMB', 'KNDI', 'BIIB', 'TRVI', 'TTMI', 'CSX', 'CHMA', 'ZGNX', 'TXRH', 'FANG', 'QRVO', 'ILMN', 'DMTK', 'PS', 'ULTA', 'MORN', 'PACB', 'MOMO', 'MACK', 'SDGR', 'VRME', 'CSII', 'AVT', 'SCOR', 'ANDE', 'SRAC', 'KROS', 'XPER', 'STRO', 'FAST', 'PATI', 'GBDC', 'INTU', 'WTFC', 'OTEL', 'WDFC', 'DMLP', 'TW', 'IBEX', 'LI', 'ADSK', 'PEP', 'ACNB', 'VRA', 'NSTG', 'CASA', 'UEIC', 'FTNT', 'TTEC', 'JVA', 'VSEC', 'CVBF', 'PRPH', 'TSC', 'FOLD', 'CARV', 'PRGS', 'MNKD', 'NWPX', 'LIVN', 'ENG', 'UFPI', 'IMAC', 'HOOK', 'ONCT', 'UPWK', 'FLEX', 'BCDA', 'PPD', 'URBN', 'QUMU', 'CREE', 'OMP', 'GOSS', 'NDSN', 'ADI', 'WEN', 'NFLX', 'ALGN', 'LOB', 'MRNA', 'WKHS', 'SPWR', 'AGIO', 'ECHO', 'CHDN', 'PCAR', 'DISH', 'DRIO', 'ANSS', 'MNPR', 'LINC', 'AKER', 'IGIC', 'ESTA', 'IVA', 'NMRK', 'QADB', 'HRZN', 'GOVX', 'SIVB', 'CAR', 'COST', 'CRVS', 'REG', 'IAC', 'ACHC', 'CDW', 'OMER', 'MAR', 'FCEL', 'ALBO', 'RADI', 'NICK', 'TROW', 'EQ', 'FFBW', 'BRQS', 'FGEN', 'RUBY', 'NXTC', 'VITL', 'MXIM', 'MU', 'DTIL', 'PETQ', 'NTLA', 'FCFS', 'CPSH', 'LQDT', 'CRNC', 'DARE', 'EXPI', 'ZIXI', 'SWKS', 'PFSW', 'ELOX', 'SAFM', 'SGBX', 'LYFT', 'CNSL', 'NBRV', 'ZI', 'CMLF', 'BIGC', 'LKQ', 'EFOI', 'THCB', 'APTX', 'UTHR', 'PEBO', 'XCUR', 'HOPE', 'EYE', 'CRSR', 'AKAM', 'BKYI', 'HMSY', 'BBI', 'CSTL', 'EXLS', 'OPRX', 'PHIO', 'DORM', 'COHU', 'MVIS', 'TFSL', 'OPRT', 'FWONA', 'MNST', 'BGFV', 'UNTY', 'FB', 'ODFL', 'STAY', 'AGNC', 'OPBK', 'PCB', 'GOGO', 'CERE', 'CIDM', 'LIQT', 'GRPN', 'WWR', 'GILD', 'ARCC', 'PLSE', 'OCC', 'WHLR', 'ACEV', 'VOXX', 'SSKN', 'SGLB', 'ICMB', 'DISCA', 'SBUX', 'PAYS', 'RAND', 'FFIC', 'SYBX', 'CROX', 'TH', 'NIU', 'SGMO', 'ACLS', 'FTIV', 'PNFP', 'LUNA', 'SVC', 'QFIN', 'ODT', 'TPIC', 'NNDM', 'FREE', 'NFE', 'SGEN', 'NLOK', 'VSPR', 'GLUU', 'WHLM', 'CERN', 'VXRT', 'CSPI', 'CENX', 'PAVM', 'ONTX', 'ROKU', 'ATRO', 'SAII', 'BNGO', 'COOP', 'THCA', 'BIOL', 'MSON', 'EXC', 'QCRH', 'DAKT', 'HBT', 'EGOV', 'ITI', 'ONEW', 'XPEL', 'DZSI', 'IMBI', 'INZY', 'HA', 'CHUY', 'ANY', 'SONN', 'SCVL', 'ACHV', 'SFM', 'UTSI', 'AGEN', 'FOXA', 'UMBF', 'IMXI', 'MGTA', 'AMTX', 'ZS', 'RNA', 'MGNX', 'CLXT', 'XOMA', 'WSFS', 'CBAT', 'STOK', 'SPWH', 'LOVE', 'MTSC', 'MELI', 'ON', 'FAT', 'BSQR', 'LSCC', 'GLG', 'VTVT', 'NWSA', 'CDZI', 'DYNT', 'AXAS', 'BBQ', 'APEN', 'ARAY', 'IMKTA', 'GIII', 'TPCO', 'LUNG', 'AREC', 'INFN', 'GPRO', 'NTRA', 'CSCO', 'HYRE', 'PSTV', 'HBAN', 'VERO', 'PCRX', 'ITOS', 'OSS', 'AYLA', 'MVBF', 'CASH', 'VACQ', 'BGCP', 'ALXN', 'SRDX', 'PFHD', 'AVNW', 'AESE', 'HTGM', 'BOXL', 'GNLN', 'SONO', 'OEG', 'SNPS', 'PAND', 'NESR', 'VIR', 'RDNT', 'SSNT', 'BBBY', 'CRWD', 'CASS', 'TVTY', 'OTIC', 'BNFT', 'RCKY', 'RPTX', 'IMNM', 'FISV', 'SNDX', 'AXTI', 'HCKT', 'PHUN', 'HAIN', 'FRPH', 'PCH', 'CRMT', 'NEXT', 'SPRT', 'SMMT', 'ACRX', 'SANM', 'ATSG', 'RBB', 'CRAI', 'RMTI', 'MOSY', 'XAIR', 'AQB', 'ADES', 'ORIC', 'KVHI', 'CYCN', 'PHAT', 'WBA', 'INVA', 'POAI', 'FDUS', 'LGHL', 'EMKR', 'WTRH', 'CDTX', 'SONM', 'SINO', 'GTEC', 'MGRC', 'EVFM', 'ICFI', 'STX', 'NCSM', 'NMRD', 'MWK', 'SABR', 'ADBE', 'FNWB', 'WLTW', 'GLAD', 'LLNW', 'GAIA', 'NKLA', 'QDEL', 'STSA', 'MIST', 'FUSN', 'MIK', 'JYNT', 'INGN', 'GRTS', 'NTAP', 'FLL', 'IESC', 'ODP', 'AKBA', 'EHTH', 'INPX', 'VSTA', 'ORPH', 'AGLE', 'BKSC', 'LULU', 'CHCO', 'MERC', 'EXPO', 'KOR', 'FTOC', 'IROQ', 'ARRY', 'HAS', 'ATRI', 'CCRN', 'FUTU', 'RDUS', 'CBTX', 'IEA', 'BDTX', 'FEYE', 'HEPA', 'NTGR', 'RILY', 'BLFS', 'CG', 'SP', 'POLA', 'NEPH', 'ALLO', 'NH', 'INSM', 'DXCM', 'LOOP', 'VERB', 'DSKE', 'NMTR', 'PCVX', 'YORW', 'PYPL', 'UONE', 'LPLA', 'GRWG', 'BRPA', 'EBAY', 'MDLZ', 'GMBL', 'MTEM', 'RAPT', 'TIPT', 'CAPR', 'ETTX', 'SEAC', 'PCSB', 'NVEC', 'CYTK', 'AMED', 'CEMI', 'CRSA', 'DMRC', 'IBTX', 'FLIR', 'GOOD', 'SPTN', 'SBAC', 'OSIS', 'TGTX', 'USIO', 'DDOG', 'MRBK', 'NNBR', 'ATNI', 'PTON', 'RELL', 'ATOM', 'DBX', 'TTGT', 'LYRA', 'LAKE', 'NUAN', 'ROST', 'ISRG', 'LMNR', 'JKHY', 'APPS', 'HAYN', 'PPC', 'RCMT', 'ARDX', 'GLDD', 'NTNX', 'ENSG', 'ICAD', 'RGNX', 'GNUS', 'BYND', 'EVOL', 'HOMB', 'SLM', 'ALOT', 'COWN', 'APXT', 'AGBA', 'WW', 'BNTC', 'MYGN', 'ETSY', 'AMRS', 'CBAY', 'MSFT', 'USAP', 'SWAV', 'GNMK', 'AHAC', 'SRCL', 'NBTB', 'ICCH', 'SECO', 'AQMS', 'MRCY', 'TMUS', 'LWAY', 'UFPT', 'XELA', 'NDAQ', 'DNLI', 'BSVN', 'EDSA', 'XGN', 'CEVA', 'TZOO', 'ATVI', 'ETNB', 'LOCO', 'JAZZ', 'SBGI', 'HQI', 'PIRS', 'MBIN', 'ALSK', 'MAT', 'WOOF', 'NLTX', 'EPSN', 'MDCA', 'MORF', 'SAIA', 'BL', 'LRMR', 'MCHP', 'CTAS', 'ITRM', 'BRKS', 'CAKE', 'QLYS', 'PI', 'ALLK', 'FGBI', 'SIGI', 'SNCR', 'XP', 'TENB', 'NWL', 'CMPI', 'ANNX', 'CNDT', 'WTER', 'LRCX', 'WIFI', 'AAON', 'TXN', 'CFMS', 'GOOGL', 'TIG', 'GXGX', 'DKNG', 'TRMK', 'MARK', 'FVCB', 'LPRO', 'HWC', 'CORE', 'APLT', 'FRTA', 'RDFN', 'EBTC', 'AVGR', 'ORRF', 'BKEP', 'BCOR', 'KOSS', 'BEEM', 'CMTL', 'LPSN', 'CTXS', 'PTC', 'HVBC', 'ZSAN', 'SINT', 'PRIM', 'ATHA', 'CELH', 'DOMO', 'RCM', 'YNDX', 'COHR', 'MBIO', 'TRHC', 'OFLX', 'CSGS', 'KTRA', 'SUNW', 'PRFT', 'ASTI', 'CPRT', 'REPL', 'STKL', 'LYTS', 'ALRN', 'TACT', 'XENE', 'SCSC', 'LNDC', 'OKTA', 'GRMN', 'WMG', 'FNKO', 'KLAC', 'RLAY', 'OPGN', 'LIVE', 'WDAY', 'RAIL', 'BIMI', 'MASI', 'AVGO', 'JACK', 'LMPX', 'IHRT', 'HARP', 'STFC', 'HUIZ', 'IBKR', 'IONS', 'NTEC', 'NAVI', 'GT', 'SYKE', 'TBIO', 'GDEN', 'LINK', 'CME', 'RIBT', 'UNIT', 'TCF', 'FLNT', 'CNMD', 'LIVX', 'BLU', 'TWST', 'GNSS', 'ASML', 'NUVA', 'CSCW', 'VIRT', 'CTXR', 'HOL', 'ACER', 'RGLD', 'PFIN', 'TNXP', 'FULC', 'FARO', 'ARLP', 'FUNC', 'PIXY', 'GEVO', 'PRTA'}

model_2 = {'SCSC', 'BSQR', 'REG', 'WHLM', 'BIGC', 'WSFS', 'DARE', 'ETTX', 'FFIC', 'ESSA', 'PENN', 'ARAY', 'THCA', 'HUIZ', 'PI', 'FLIR', 'LMNR', 'MNKD', 'CSGS', 'WKHS', 'SSKN', 'UTHR', 'SCOR', 'FDUS', 'MOSY', 'CRON', 'STSA', 'NMRK', 'MVBF', 'UEIC', 'GXGX', 'JYNT', 'FNKO', 'GIII', 'FLEX', 'NXTC', 'PPD', 'RGCO', 'GLDD', 'ACHC', 'FNLC', 'FULC', 'RPTX', 'EHTH', 'PNFP', 'CG', 'PRPH', 'TRCH', 'ACLS', 'QUIK', 'ARCC', 'ZS', 'BNTC', 'VITL', 'DOMO', 'RCKY', 'ARAY', 'COST', 'LYTS', 'ICAD', 'PHAT', 'ULTA', 'VSPR', 'DIOD', 'WDFC', 'CRMT', 'ZGNX', 'SVRA', 'FAST', 'AVT', 'JAZZ', 'FCEL', 'BNFT', 'ITOS', 'PEBO', 'CORE', 'FRPT', 'CAR', 'HSIC', 'GEVO', 'ATHA', 'FARO', 'VERB', 'CHMA', 'WDFC', 'REG', 'PIRS', 'DRIO', 'OKTA', 'ZUMZ', 'HARP', 'PRTA', 'MDCA', 'PI', 'SBGI', 'AGNC', 'ULTA', 'FAT', 'MVBF', 'TWST', 'WIFI', 'OSTK', 'BL', 'HOMB', 'USAP', 'ETNB', 'CNSP', 'AAON', 'FULT', 'BIIB', 'RCMT', 'XPEL', 'STAA', 'CPSH', 'LMNR', 'BGFV', 'MLAC', 'ALSK', 'PFIN', 'CMCSA', 'STAY', 'TROW', 'AQMS', 'GXGX', 'BLNK', 'SNCR', 'IMKTA', 'CG', 'GPRO', 'RKDA', 'PTON', 'ADBE', 'LUNA', 'SABR', 'SINO', 'EYE', 'ICFI', 'EGAN', 'KOSS', 'AMPH', 'STOK', 'LPSN', 'YORW', 'MXIM', 'FOXA', 'ONEW', 'NWPX', 'CDW', 'WBA', 'BIMI', 'AMRS', 'PNFP', 'GT', 'OCC', 'ASUR', 'CCRN', 'AMTX', 'ICCH', 'KNDI', 'ADI', 'CRWD', 'HOPE', 'VSTA', 'NTLA', 'DMLP', 'GOVX', 'PPC', 'CELH', 'ROST', 'XPEL', 'CIDM', 'GOSS', 'LASR', 'SND', 'DZSI', 'INPX', 'LAKE', 'LNDC', 'DBX', 'PYPL', 'DMTK', 'JKHY', 'QUMU', 'EFOI', 'UONE', 'DENN', 'FOLD', 'TZOO', 'BLU', 'INSM', 'AXLA', 'IHRT', 'MU', 'RCMT', 'APXT', 'BKSC', 'LWAY', 'VACQ', 'NLTX', 'CRSR', 'NLOK', 'TGTX', 'MSFT', 'GRWG', 'ROKU', 'SBGI', 'ONCT', 'DISH', 'QLYS', 'BOXL', 'SPRT', 'BBBY', 'VXRT', 'XAIR', 'GTEC', 'BLFS', 'ADUS', 'CASS', 'MARK', 'ODT', 'ATSG', 'SANM', 'EXTR', 'SIGI', 'ZM', 'IONS', 'APEN', 'PAND', 'LE', 'DMLP', 'EVFM', 'AKAM', 'ANY', 'RGNX', 'FFBW', 'XGN', 'SMMT', 'FWONA', 'COOP', 'HCKT', 'IROQ', 'ZSAN', 'EGOV', 'CASA', 'ODP', 'PACB', 'SPWR', 'ACER', 'COWN', 'NDAQ', 'HOFV', 'OPBK', 'TTGT', 'PCRX', 'CHDN', 'SRNE', 'NBTB', 'RAPT', 'RGLD', 'CMCSA', 'TRHC', 'LUNA', 'WW', 'AHAC', 'MSON', 'OSIS', 'HYRE', 'PHUN', 'SVMK', 'FRTA', 'VERO', 'AXTI', 'SAL', 'ASTE', 'STFC', 'PLAB', 'MACK', 'GNUS', 'ATNI', 'KVHI', 'UTSI', 'HEPA', 'EBTC', 'ADSK', 'EXPO', 'NMTR', 'OSS', 'BGCP', 'KVHI', 'LINC', 'EXLS', 'POAI', 'OFLX', 'ATRI', 'HVBC', 'RAIL', 'LMPX', 'FGBI', 'ESCA', 'AMED', 'TZOO', 'NNBR', 'CHCO', 'OPRA', 'FULT', 'GDEN', 'ENG', 'BYND', 'HPK', 'EXC', 'RCM', 'SPOK', 'ALBO', 'PLMR', 'MYSZ', 'CTAS', 'LRCX', 'SYBX', 'NUVA', 'VIRT', 'GBDC', 'ATRO', 'AMED', 'SCHL', 'LHCG', 'FIVE', 'GNSS', 'IMXI', 'CIDM', 'FFBW', 'RDNT', 'ANSS', 'WTFC', 'VIR', 'FNWB', 'CNMD', 'XOMA', 'LPRO', 'RDFN', 'CARV', 'REPL', 'LAKE', 'GRPN', 'NTAP', 'AGEN', 'LYRA', 'ON', 'AGLE', 'RADI', 'TXN', 'NMRD', 'SGBX', 'LI', 'CSX', 'STRA', 'IBKR', 'NESR', 'PATI', 'XPER', 'OPRT', 'BSVN', 'TXRH', 'HAIN', 'GLAD', 'LUNG', 'COHU', 'NNDM', 'SRAC', 'HBAN', 'ZI', 'LKQ', 'LRMR', 'RNA', 'WTER', 'SONN', 'SNCR', 'TW', 'CVBF', 'STKS', 'AGNC', 'ORIC', 'FNLC', 'SIVB', 'TVTY', 'DORM', 'ASML', 'ATEX', 'MAT', 'SNES', 'AKER', 'NWSA', 'IMNM', 'GNMK', 'RIOT', 'APTX', 'RMTI', 'AVGO', 'GRMN', 'CSPI', 'ILMN', 'TNXP', 'INGN', 'AGIO', 'EXPI', 'DYNT', 'YORW', 'LYFT', 'ENSG', 'NTRA', 'RLAY', 'HMSY', 'TCF', 'BNGO', 'FCFS', 'KROS', 'LIVE', 'EBAY', 'FISI', 'CYCN', 'IGIC', 'CME', 'HOL', 'NKLA', 'UFPT', 'MRCY', 'AVNW', 'BBQ', 'BCOR', 'PRIM', 'TPIC', 'TWIN', 'ARDX', 'CRSA', 'ZIXI', 'UNTY', 'WEN', 'ACRX', 'ORPH', 'XP', 'FRPH', 'KTRA', 'ESTA', 'WLTW', 'SSKN', 'ASML', 'WSFS', 'UNTY', 'ECHO', 'ACHV', 'NWSA', 'ASTI', 'XPER', 'EDSA', 'OPGN', 'VOXX', 'BIOL', 'DAKT', 'LWAY', 'ANAB', 'SLM', 'IESC', 'NICK', 'FVCB', 'NICK', 'PFIN', 'BCDA', 'LSCC', 'MACK', 'LIQT', 'ANDE', 'LOCO', 'ACNB', 'DTIL', 'MAR', 'CEVA', 'TRMB', 'LOB', 'CDZI', 'BIOC', 'MIST', 'MGNX', 'DXCM', 'DMRC', 'UNIT', 'PEP', 'STX', 'NFE', 'CREE', 'EPSN', 'SWAV', 'LPLA', 'TIG', 'AZN', 'CNSL', 'HSTM', 'QADB', 'MELI', 'TPCO', 'MNST', 'MRBK', 'SIVB', 'FB', 'TER', 'FUNC', 'BKNG', 'BBBY', 'MRNA', 'CERE', 'MORF', 'ELOX', 'HBT', 'PETQ', 'UPWK', 'ASUR', 'FISV', 'MMAC', 'MDLZ', 'AYLA', 'ALXN', 'ALGT', 'WMG', 'DISCA', 'LOOP', 'AREC', 'CRAI', 'FRPH', 'TENB', 'SLDB', 'NIU', 'TSC', 'MYGN', 'PLSE', 'QDEL', 'ITRM', 'WDAY', 'CVBF', 'ANIK', 'HWC', 'IBKR', 'CDEV', 'NAVI', 'SYKE', 'ISRG', 'OEG', 'BRID', 'CRVS', 'SAIA', 'OPRX', 'ADTX', 'NTEC', 'SGMO', 'MIK', 'SONM', 'GOGO', 'BRQS', 'ALLK', 'TFSL', 'NARI', 'FGEN', 'ANNX', 'LLNW', 'BCOR', 'HRZN', 'PCB', 'CEMI', 'CASH', 'IBTX', 'FTNT', 'EQ', 'UMBF', 'FGBI', 'PAYS', 'ALXN', 'VISL', 'NVEC', 'ALOT', 'MGTA', 'SWAV', 'ODFL', 'OFLX', 'EXPO', 'CFMS', 'VITL', 'WTFC', 'LINK', 'SGLB', 'GNLN', 'GOOGL', 'RDUS', 'RADA', 'CSTL', 'RUBY', 'EMKR', 'INFN', 'FUSN', 'CREE', 'CENX', 'CONN', 'MOMO', 'PCSA', 'SBAC', 'PPC', 'MDLZ', 'OPRX', 'SNPS', 'IMAC', 'OMP', 'SUNW', 'AESE', 'TACT', 'AVGO', 'IGIC', 'KLAC', 'CAKE', 'QFIN', 'STRO', 'AQB', 'DNLI', 'DKNG', 'ALEC', 'SP', 'UTHR', 'PRFT', 'TELA', 'HAS', 'NSTG', 'ALLO', 'CROX', 'ORRF', 'GLUU', 'HBT', 'MTSC', 'RBB', 'CARV', 'NTGR', 'PS', 'ATVI', 'WHLR', 'UFPI', 'SP', 'HSTM', 'GLDD', 'BIMI', 'NDSN', 'FREE', 'MVIS', 'LQDT', 'FTOC', 'MRBK', 'SYBX', 'EXC', 'BDTX', 'SBUX', 'POLA', 'NH', 'ADXS', 'NTGR', 'SCWX', 'ARLP', 'GNUS', 'ITI', 'TRVI', 'SPWH', 'CTXS', 'GMBL', 'CLXT', 'SAII', 'RAND', 'JACK', 'MGI', 'NUAN', 'ATRI', 'MCHP', 'MU', 'HQI', 'USAP', 'CYTK', 'CBTX', 'AXAS', 'ETSY', 'RCHG', 'RIBT', 'WTRH', 'SSNT', 'IMBI', 'LIVN', 'TFSL', 'ARRY', 'GRTS', 'SWKS', 'TCF', 'PCVX', 'CBAY', 'MNPR', 'VSEC', 'PRGS', 'QCRH', 'SAFM', 'HA', 'CAPR', 'LGHL', 'HMSY', 'AVGR', 'GTEC', 'INVA', 'VTVT', 'HOOK', 'APPS', 'SCVL', 'XENE', 'QCRH', 'AXAS', 'NEPH', 'CAR', 'BKEP', 'SRAX', 'CDTX', 'PIXY', 'NCSM', 'JVA', 'FISI', 'MWK', 'RILY', 'BNFT', 'KOR', 'DISH', 'OPBK', 'OTEL', 'DOCU', 'VRA', 'SPTN', 'ONTX', 'EBTC', 'NEXT', 'CHCO', 'TLRY', 'PENN', 'INTU', 'AKRO', 'ORRF', 'TMUS', 'FLL', 'PHIO', 'DDOG', 'CMTL', 'NWL', 'RDI', 'CNDT', 'BGFV', 'IEA', 'GLG', 'ROST', 'CTXR', 'RBB', 'NVAX', 'VRME', 'TTEC', 'AAPL', 'DNLI', 'XCUR', 'TH', 'MTEM', 'NAVI', 'BGCP', 'CMLF', 'NBRV', 'BRKS', 'WOOF', 'SDGR', 'HTGM', 'CERN', 'AAL', 'FLNT', 'AGBA', 'MERC', 'SRDX', 'PFSW', 'FFIC', 'PCH', 'IBEX', 'XBIT', 'DIOD', 'ADMA', 'SFM', 'TTMI', 'LIVX', 'CSCO', 'CNDT', 'LOGI', 'THCB', 'ACNB', 'OTIC', 'SIGI', 'OMER', 'PTC', 'SEAC', 'COHR', 'XELA', 'BRPA', 'TSC', 'URBN', 'HAYN', 'EVOL', 'SWKS', 'EXPE', 'SVC', 'FNCB', 'SND', 'LULU', 'ACST', 'RILY', 'BKYI', 'CRNC', 'TRMK', 'RELL', 'DSKE', 'PCAR', 'ACEV', 'SYNA', 'CSCW', 'LOVE', 'GOOD', 'FUTU', 'LRCX', 'YNDX', 'SGEN', 'MERC', 'MASI', 'ICMB', 'NCSM', 'UPWK', 'INZY', 'SRCL', 'IAC', 'IVA', 'CPRT', 'CACC', 'KLAC', 'SECO', 'NTNX', 'CASS', 'SINT', 'WWR', 'TSRI', 'QRVO', 'CASH', 'CMPI', 'FLUX', 'TBIO', 'AKBA', 'UFPT', 'CBAT', 'QADB', 'PAVM', 'ADES', 'MBIO', 'COOP', 'NFLX', 'BBI', 'USIO', 'AVAV', 'GILD', 'CSII', 'INGN', 'PCSB', 'ATOM', 'FTIV', 'GAIA', 'FUNC', 'SNDX', 'COUP', 'STKL', 'PFHD', 'UMBF', 'CARA', 'MGRC', 'TIPT', 'FEYE', 'SONO', 'GLUU', 'NNBR', 'ALGN', 'MMAC', 'PSTV', 'LOB', 'TTGT', 'LPLA', 'BEEM', 'AAME', 'APLT', 'MORN', 'FDUS', 'CHUY', 'ALRN', 'PCB', 'FANG', 'MBIN'}

model_3 = {'JAZZ', 'HQI', 'ICMB', 'LPRO', 'ANAB', 'TGTX', 'ANY', 'ACHV', 'HSTM', 'SINT', 'NUAN', 'UPWK', 'PHUN', 'CACC', 'INPX', 'HOPE', 'FOLD', 'SGLB', 'SDGR', 'OMP', 'CREE', 'MSON', 'PYPL', 'VIAC', 'GAIA', 'ADUS', 'ORIC', 'AAME', 'JKHY', 'UTHR', 'LOVE', 'CARV', 'RAIL', 'CLXT', 'STRO', 'FUNC', 'UPWK', 'NMRK', 'AQB', 'BBI', 'NTRA', 'GOSS', 'NWSA', 'QDEL', 'PDD', 'WW', 'CVBF', 'SGBX', 'FLL', 'PTON', 'AMZN', 'RCKY', 'RCHG', 'INTU', 'FUTU', 'ZS', 'FNLC', 'QLYS', 'FFIC', 'AKBA', 'NH', 'ANIK', 'ONTX', 'ZIXI', 'EVOL', 'FNLC', 'CREE', 'NICK', 'FUSN', 'WHLR', 'ASTE', 'LQDT', 'FISV', 'NTGR', 'ACNB', 'BKEP', 'EBTC', 'EPSN', 'RBB', 'VG', 'IGIC', 'IONS', 'GOOD', 'HOOK', 'MARK', 'APTX', 'CSGS', 'LUNG', 'TRMK', 'NKLA', 'ISRG', 'OPRA', 'HUIZ', 'TXN', 'ONCT', 'SIVB', 'SND', 'CME', 'RELL', 'MNKD', 'LMNR', 'NLTX', 'ORRF', 'CRNC', 'VRME', 'MIK', 'ETSY', 'NEXT', 'FANG', 'EXPO', 'FFIC', 'ATRI', 'SCHL', 'PCVX', 'NUVA', 'WTFC', 'BLFS', 'CYCN', 'HBT', 'SRAC', 'LE', 'HYRE', 'ADI', 'GNUS', 'CMCSA', 'AMAT', 'FWONA', 'XBIT', 'EVFM', 'UEIC', 'CERE', 'QUIK', 'CDTX', 'TRCH', 'INGN', 'LINK', 'PCB', 'BDTX', 'HPK', 'CSX', 'HAYN', 'VACQ', 'WSFS', 'FULT', 'SRNE', 'WWR', 'WATT', 'NVAX', 'PIXY', 'RAND', 'PNFP', 'CRAI', 'SWKS', 'STKL', 'ATHA', 'TENB', 'HOFV', 'FNKO', 'IBKR', 'CELH', 'MVIS', 'UFPT', 'MRCY', 'ARCC', 'SSKN', 'SCOR', 'SFM', 'UNTY', 'TSC', 'LYFT', 'SND', 'USIO', 'FISV', 'PS', 'FLNT', 'SEAC', 'IMBI', 'ACNB', 'SBGI', 'IVA', 'NTGR', 'ACHC', 'DISH', 'IMXI', 'WTER', 'TMUS', 'RIOT', 'YORW', 'PFIN', 'OKTA', 'CERN', 'BIMI', 'CVBF', 'FGBI', 'SPRT', 'IBKR', 'HAS', 'GBDC', 'RKDA', 'EXTR', 'NTLA', 'XGN', 'ESSA', 'PSTV', 'OSTK', 'GT', 'KOSS', 'ADES', 'NESR', 'CSGP', 'NMTR', 'TXRH', 'VRM', 'AVGO', 'NNBR', 'BKSC', 'CTXR', 'BIOC', 'CNDT', 'CTXS', 'GDS', 'NVDA', 'ADSK', 'ISRG', 'MNPR', 'DISH', 'GRMN', 'GXGX', 'QUMU', 'LOB', 'VOXX', 'EYE', 'FOXA', 'PCSB', 'VERO', 'INTU', 'ARRY', 'TIPT', 'MERC', 'GOGO', 'GOOGL', 'DMLP', 'ETSY', 'NFLX', 'FRTA', 'YORW', 'ASTI', 'LIQT', 'PPD', 'BBBY', 'DDOG', 'FULC', 'HCKT', 'MOSY', 'NTAP', 'CCRN', 'SBAC', 'ASUR', 'NBTB', 'PFSW', 'IMKTA', 'CDW', 'EXC', 'NTGR', 'CRWD', 'TCF', 'CROX', 'ADTX', 'SYBX', 'FOXA', 'ACST', 'STAA', 'CG', 'FARO', 'AXTI', 'DOCU', 'CMCSA', 'AMD', 'HA', 'OPBK', 'GLAD', 'MAR', 'APEN', 'ATSG', 'URBN', 'FTNT', 'CMPI', 'BGFV', 'BIMI', 'RGNX', 'AAPL', 'CASH', 'FNWB', 'HBAN', 'ADUS', 'FAT', 'CVBF', 'ARCB', 'OTIC', 'TRMB', 'ALGT', 'IBEX', 'WYNN', 'ZSAN', 'BLU', 'SUNW', 'HSTM', 'EGOV', 'RCMT', 'GLDD', 'TRVI', 'WSFS', 'INTC', 'PRFT', 'POAI', 'FCFS', 'RADA', 'CSCW', 'LNDC', 'ZG', 'SNPS', 'NAVI', 'ACRX', 'TZOO', 'CAR', 'EXPE', 'AGLE', 'ALLO', 'MYSZ', 'ROST', 'SCSC', 'DOMO', 'LWAY', 'EHTH', 'WIFI', 'ATOM', 'SDGR', 'JACK', 'XPER', 'GLUU', 'FDUS', 'ALGN', 'ORPH', 'MGRC', 'BGNE', 'INZY', 'TROW', 'SP', 'COWN', 'VSTA', 'TER', 'DNLI', 'EXPI', 'DNLI', 'EXPE', 'AXAS', 'SRAX', 'CASA', 'MTSC', 'LLNW', 'ATVI', 'DENN', 'HRZN', 'SPTN', 'LPLA', 'CAKE', 'ALXN', 'TTGT', 'ODFL', 'IHRT', 'MU', 'INSM', 'GOGO', 'AGNC', 'TSLA', 'FISI', 'PAVM', 'STAY', 'BYND', 'MNST', 'RUBY', 'HSTM', 'PRPH', 'TELA', 'GLUU', 'HVBC', 'OPRX', 'BBQ', 'SRDX', 'GTEC', 'CARV', 'UNIT', 'ROST', 'ARCC', 'SWAV', 'DXCM', 'UFPT', 'PCB', 'CDZI', 'RBB', 'WKHS', 'MDLZ', 'VISL', 'FRPH', 'LRMR', 'CREE', 'CSX', 'STFC', 'DSKE', 'STSA', 'VSPR', 'TVTY', 'ALRN', 'IMAC', 'XENE', 'AYLA', 'WING', 'NICK', 'EXLS', 'UMBF', 'UFPI', 'RMTI', 'PFHD', 'CNSP', 'RCMT', 'SIVB', 'WLTW', 'MVIS', 'LAKE', 'TURN', 'NWSA', 'VITL', 'IESC', 'DMTK', 'ELOX', 'TSC', 'PCSA', 'KLAC', 'IROQ', 'LULU', 'CROX', 'MU', 'PHIO', 'ALXN', 'ULTA', 'STRA', 'CMCSA', 'RLAY', 'AZN', 'ROKU', 'PYPL', 'BRID', 'SNDX', 'ULTA', 'UMBF', 'DDOG', 'NTNX', 'SP', 'ALSK', 'AZN', 'TTEC', 'XAIR', 'CRWD', 'CPRT', 'BGCP', 'DMLP', 'PRTA', 'SCWX', 'RGLD', 'LYTS', 'BNFT', 'RDNT', 'ORRF', 'PI', 'SGEN', 'CEVA', 'CTAS', 'PS', 'TIG', 'VTVT', 'NDAQ', 'LKQ', 'DISCA', 'RGCO', 'QCRH', 'CRSA', 'LULU', 'TPIC', 'TZOO', 'LASR', 'BKNG', 'FFBW', 'ECHO', 'FRPT', 'ALOT', 'LWAY', 'CAR', 'SONN', 'STOK', 'AKRO', 'NVEC', 'GLG', 'ANDE', 'OPGN', 'TWIN', 'AQMS', 'CNMD', 'AVT', 'MU', 'PCAR', 'CHDN', 'STKS', 'MGNX', 'ENG', 'MAT', 'MBIO', 'BSQR', 'MMAC', 'PLAB', 'OEG', 'FFBW', 'CHMA', 'AMRS', 'SBGI', 'LRCX', 'SYKE', 'ZS', 'LIVE', 'IGIC', 'KTRA', 'ESCA', 'APLT', 'TCF', 'CAR', 'RDI', 'GIII', 'INSM', 'SPWR', 'FGEN', 'SECO', 'EXC', 'SUNW', 'NFE', 'AMTX', 'APPS', 'SLM', 'AREC', 'MGTA', 'NWPX', 'HBT', 'IBKR', 'KOR', 'NWSA', 'FB', 'AVGO', 'JVA', 'BCOR', 'HBAN', 'SYNA', 'ASTI', 'BIDU', 'NEPH', 'CHCO', 'MAR', 'OPGN', 'CIDM', 'COOP', 'AKAM', 'ICCH', 'GEVO', 'AESE', 'ATRO', 'MORN', 'HOL', 'EMKR', 'LOB', 'ADSK', 'NTEC', 'TTMI', 'QRVO', 'AXTI', 'SPWH', 'NCSM', 'BKYI', 'SIGI', 'TTGT', 'ARAY', 'MRBK', 'XPEL', 'NARI', 'DBX', 'GNSS', 'SAL', 'ZI', 'SABR', 'SCVL', 'NVAX', 'TROW', 'GRWG', 'PLSE', 'TXN', 'NDSN', 'NFLX', 'WDAY', 'NNBR', 'BGCP', 'OPRT', 'PLUG', 'SNCR', 'ANSS', 'CRSR', 'CMLF', 'COUP', 'FLEX', 'PRIM', 'LGHL', 'DYNT', 'ATSG', 'GNUS', 'AMED', 'WBA', 'TNXP', 'GOOGL', 'AMTX', 'STX', 'ON', 'DAKT', 'MWK', 'MDLZ', 'MTEM', 'ESTA', 'MARK', 'ARDX', 'REG', 'CG', 'BL', 'RIBT', 'IBTX', 'WTFC', 'MRNA', 'MOMO', 'DTIL', 'MSTR', 'CARA', 'SRCL', 'COHU', 'ADI', 'SBAC', 'MSFT', 'CRVS', 'VIRT', 'RAPT', 'IHRT', 'FUNC', 'ITOS', 'RILY', 'ASML', 'BSVN', 'RGCO', 'TH', 'FLIR', 'MACK', 'TFSL', 'PI', 'SMMT', 'HAIN', 'EDSA', 'SSKN', 'PCRX', 'FREE', 'PRGS', 'ZM', 'QCRH', 'CSGS', 'MIST', 'PTC', 'ONEW', 'NDAQ', 'DISCA', 'BL', 'SVRA', 'SRCL', 'NWL', 'MVBF', 'UNTY', 'ATNI', 'AGBA', 'LUNA', 'LHCG', 'XELA', 'MDCA', 'CLSK', 'TTGT', 'BNFT', 'OTEL', 'OSS', 'HWC', 'AAL', 'ON', 'SAFM', 'SIVB', 'ITI', 'KNDI', 'BIIB', 'DZSI', 'XPEL', 'FDUS', 'ARLP', 'LOOP', 'LE', 'PAYS', 'AMRS', 'LUNA', 'HEPA', 'ICFI', 'BEEM', 'ALSK', 'MACK', 'HMSY', 'FGBI', 'PACB', 'GXGX', 'CSII', 'SPOK', 'ADBE', 'HSIC', 'WDFC', 'QADB', 'LIVN', 'PENN', 'PEP', 'OSIS', 'TTD', 'CASH', 'SGMO', 'CBAY', 'MXIM', 'LPSN', 'PNFP', 'RNA', 'ADMA', 'UONE', 'EXPO', 'LI', 'CORE', 'CNDT', 'CBTX', 'LRCX', 'ARAY', 'NNBR', 'BNGO', 'ODFL', 'DMRC', 'CONN', 'BNTC', 'SBUX', 'BRQS', 'INVA', 'SAIA', 'PENN', 'MLAC', 'ADXS', 'COHR', 'AKER', 'BCDA', 'CSCO', 'TWST', 'COOP', 'FISI', 'VERB', 'AGEN', 'WOOF', 'WIFI', 'GRWG', 'NXTC', 'LOCO', 'KLAC', 'CG', 'TACT', 'SONM', 'FVCB', 'RPTX', 'LOGI', 'PATI', 'LIVX', 'APXT', 'REPL', 'FNCB', 'GILD', 'EXC', 'INGN', 'GTEC', 'MORF', 'ODP', 'ATEX', 'BRKS', 'XOMA', 'AGNC', 'SNES', 'TPCO', 'QFIN', 'PAND', 'CODX', 'ACER', 'EGAN', 'PLMR', 'TBIO', 'ENSG', 'RCM', 'RILY', 'ICAD', 'HOMB', 'MRNA', 'LAKE', 'SVC', 'CPRT', 'SYBX', 'ITRM', 'GNMK', 'SSNT', 'FCEL', 'ANNX', 'ODT', 'UTHR', 'MGI', 'OSS', 'AXLA', 'LPLA', 'FIVE', 'CRON', 'AVAV', 'AMED', 'MXIM', 'JYNT', 'NNDM', 'AVGO', 'IBEX', 'CAPR', 'SIGI', 'HMSY', 'NTRA', 'MELI', 'MYGN', 'STRA', 'JD', 'PPC', 'YNDX', 'ITI', 'NSTG', 'KROS', 'CNSL', 'AXAS', 'FAST', 'GRTS', 'WTRH', 'EBAY', 'CDEV', 'KVHI', 'CNSL', 'RAIL', 'XPER', 'EFOI', 'ACLS', 'SANM', 'BRPA', 'COST', 'GRPN', 'ATVI', 'CSTL', 'QDEL', 'MASI', 'MVBF', 'BIGC', 'NAVI', 'PCH', 'DRIO', 'NFE', 'USAP', 'REG', 'PIRS', 'MRBK', 'IIVI', 'PETQ', 'CPSH', 'FTIV', 'IEA', 'OFLX', 'DIOD', 'KOSS', 'SNCR', 'BGFV', 'DISH', 'THCA', 'OPRX', 'ALBO', 'CHCO', 'ZUMZ', 'SAII', 'BIOL', 'LMNR', 'GPRO', 'INFN', 'VRA', 'DXCM', 'WHLM', 'YORW', 'IRTC', 'CASS', 'ASML', 'REGN', 'ATEX', 'FWONA', 'AHAC', 'OPBK', 'SINO', 'NMRD', 'NCSM', 'AGIO', 'PPC', 'CRMT', 'AVNW', 'GNLN', 'TFSL', 'FEYE', 'NIU', 'OCC', 'ALEC', 'LYRA', 'FULT', 'RDFN', 'MERC', 'ASML', 'MELI', 'CYTK', 'AMPH', 'NBRV', 'AAON', 'TMUS', 'MMAC', 'CHUY', 'FUTU', 'SWKS', 'NAVI', 'OMER', 'LINC', 'USAP', 'CELH', 'LPLA', 'IMNM', 'NEXT', 'HARP', 'WEN', 'LI', 'ATRI', 'LRCX', 'SONN', 'PHAT', 'VSEC', 'GEVO', 'THCB', 'ETTX', 'PENN', 'SLDB', 'SBGI', 'GDEN', 'DKNG', 'RDUS', 'LOGI', 'DARE', 'MORN', 'SONO', 'DORM', 'NLOK', 'LSCC', 'TLRY', 'OFLX', 'WMG', 'CENX', 'EBTC', 'VITL', 'ZGNX', 'SONM', 'GMBL', 'WDFC', 'AXAS', 'ARAY', 'SINO', 'BOXL', 'ADBE', 'AVGR', 'ALLK', 'VIR', 'CIDM', 'ASUR', 'TW', 'MBIN', 'BCOR', 'PEBO', 'BKNG', 'CEMI', 'WDAY', 'FLUX', 'VXRT', 'RADI', 'BLNK', 'DIOD', 'PTON', 'CSPI', 'CBAT', 'ACEV', 'CME', 'KVHI', 'GLDD', 'CACC', 'XCUR', 'CDZI', 'ETNB', 'RIOT', 'TRHC', 'DSKE', 'SRPT', 'CMTL', 'BBBY', 'UTSI', 'SWAV', 'GOVX', 'OEG', 'FRPH', 'XP', 'SAIA', 'QADB', 'TSRI', 'HTGM', 'DKNG', 'KLAC', 'EQ', 'SVMK', 'CFMS', 'FTOC', 'IAC', 'ILMN', 'MCHP', 'CASS', 'ROKU', 'PFIN', 'POLA', 'LMPX'}

def test_foo():
    # Arrange
    tickers = model_1.intersection(model_2.intersection(model_3))
    # Act
    print(tickers)
    # Assert

